webpackJsonp([1,0],[function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}var n=a(2),i=s(n),o=a(15),d=s(o),c=a(16),r=s(c),u=a(13),l=s(u),p=a(10),h=s(p);a(6),a(7),i.default.use(r.default),i.default.use(d.default),i.default.use(h.default);var k=new r.default({linkActiveClass:"active"});console.log("test aa"),k.start(l.default,"#app")},function(t,e){"use strict";function a(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}function s(){var t=new Date;return[+new Date(t.getFullYear(),t.getMonth(),t.getDate()),+new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0,0,-1)]}t.exports={formatDate:a,getTodayRange:s}},,function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={bind:function(){var t=this;this.documentHandler=function(e){return!t.el.contains(e.target)&&void(t.expression&&t.vm[t.expression]())},document.addEventListener("click",this.documentHandler)},update:function(){},unbind:function(){document.removeEventListener("click",this.documentHandler)}}},function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(14),i=s(n),o=a(1),d="day",c="week",r="month",u=864e5;e.default={data:function(){return{taskType:"ALL",dateRange:[],dateType:""}},components:{task:i.default},created:function(){this.dateType=d,this.dateRange=(0,o.getTodayRange)()},computed:{isToday:function(){return this.dateType===d&&(new Date).toDateString()===new Date(this.dateRange[0]).toDateString()}},methods:{setDateType:function(t){var e=[],a=this.dateRange;switch(this.dateType=t.toLowerCase(),t){case"DAY":e.push(a[0]),e.push(a[0]+u-1e3);break;case"WEEK":var s=new Date(a[0]).getDay();s=0===s?7:s,e.push(a[0]-(s-1)*u),e.push(a[0]+(8-s)*u-1e3);break;case"MONTH":var n=new Date(a[0]),i=+new Date(n.getFullYear(),n.getMonth(),1),o=+new Date(n.getFullYear(),n.getMonth()+1,0);e.push(i),e.push(o)}this.dateRange=e},setToday:function(){this.dateType=d,this.dateRange=(0,o.getTodayRange)()},changeDate:function(t){var e=1,a=-1,s=[],n=this.dateRange,i=7;if(t===a)switch(this.dateType){case d:i=1;case c:s.push(n[0]-i*u),s.push(n[1]-i*u);break;case r:var o=new Date(n[0]),l=+new Date(o.getFullYear(),o.getMonth()-1,1),p=+new Date(o.getFullYear(),o.getMonth(),0);s.push(l),s.push(p)}else if(t===e)switch(this.dateType){case d:i=1;case c:s.push(n[0]+i*u),s.push(n[1]+i*u);break;case r:var h=new Date(n[0]),k=+new Date(h.getFullYear(),h.getMonth()+1,1),g=+new Date(h.getFullYear(),h.getMonth()+2,0);s.push(k),s.push(g)}this.dateRange=s}},filters:{dateFMT:function(t){if(Array.isArray(t)&&2===t.length)return(0,o.formatDate)(t[0])+"~"+(0,o.formatDate)(t[1])}}}},function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(3),i=s(n),o=a(1),d=1,c=0;e.default={props:{taskRank:{type:Number,required:!0},dateRange:{type:Array,required:!0},taskType:{type:String,required:!0}},directives:{clickoutside:i.default},data:function(){return{title:"",addInputShow:!1,height:0,taskDateRange:[],taskList:[],columns:[{title:"任务名",key:"title"},{title:"开始时间",key:"startTime"},{title:"结束时间",key:"endTime"},{title:"操作",key:"state",render:function(t,e,a){var s=t.state;return 1===s?'<i-button type="primary" size="small">查看</i-button><i-button type="error" size="small" @click="removeTask('+a+')">删除</i-button>':'<i-button type="success" size="small" @click="finishTask('+a+')">完成</i-button><i-button type="error" size="small" @click="removeTask('+a+')">删除</i-button>'}}]}},created:function(){this.classMap=[null,"error","warn","info","success"],this.textMap=[null,"很重要-很紧急","重要不紧急","不重要-紧急","不重要-不紧急"],this.taskDateRange=(0,o.getTodayRange)(),this.getTasks()},ready:function(){console.log(document.getElementsByClassName("task")[0].offsetHeight),this.height=document.getElementsByClassName("rank"+this.taskRank)[0].offsetHeight-50},watch:{dateRange:function(){console.log("dateRange changing"),this.getTasks()},taskType:function(){console.log("dateType changing"),this.getTasks()}},methods:{showInput:function(){console.log("添加dsa"),this.addInputShow||(this.addInputShow=!0);var t=this;this.$nextTick(function(){t.disableClickOutSide=!0})},handleClose:function(){this.disableClickOutSide&&(console.log("关闭"),this.addInputShow&&(this.addInputShow=!1))},getTasks:function(t){var e=this,a=this.dateRange,s=this.taskRank,n=this.taskType;this.$http.get("/api/todoList",{params:{dateRange:{dateStart:new Date(a[0]).toISOString(),dateEnd:new Date(a[1]).toISOString()},taskRank:s,taskType:n}}).then(function(a){var s=a.body;if(s.status===d){var n=s.data.docs;e.taskList=n.map(function(t){return{id:t._id,title:t.title,startTime:(0,o.formatDate)(new Date(t.startTime)),endTime:(0,o.formatDate)(new Date(t.endTime)),state:t.state}}),t&&t(a)}})},addTask:function(){var t=this;console.log("addTask..."),this.addInputShow=!1;var e=this.taskDateRange,a=this.title,s=this.taskRank;this.title="",this.$http.post("/api/todo",{title:a,description:"",startTime:new Date(e[0]).toISOString(),endTime:new Date(e[1]).toISOString(),rank:s,state:c}).then(function(e){var a=e.body;a.status===d&&t.getTasks()})},finishTask:function(t){var e=this,a=this.taskList[t].id;this.$http.put("/api/todo",{id:a,state:1}).then(function(t){t.body.status===d&&e.getTasks()})},removeTask:function(t){var e=this;console.log(t);var a=this.taskList[t].id;this.$http.delete("/api/todo",{params:{id:a}}).then(function(t){var a=t.body.status;a===d&&e.getTasks()})}}}},function(t,e){},function(t,e){},function(t,e){},function(t,e){},,function(t,e){t.exports=' <div id=main> <div class=body> <div class=header> <div class=date-pick-wrapper> <div class=date-pick-show> <span id=date-show v-text=dateRange|dateFMT></span> <i class="icon icon-angle-left" @click=changeDate(-1)></i> <i class="icon icon-angle-right" @click=changeDate(1)></i> </div> <div class=date-pick> <span class=today :class="{\'active\':isToday}" @click=setToday>今天</span> <ul class=type-pick> <li @click="setDateType(\'DAY\')" :class="{active:dateType===\'day\'}">日</li> <li @click="setDateType(\'WEEK\')" :class="{active:dateType===\'week\'}">周</li> <li @click="setDateType(\'MONTH\')" :class="{active:dateType===\'month\'}">月</li> </ul> </div> </div> <div class=task-type> <div class=select-wrapper> <i-select style=width:100px :model.sync=taskType> <i-option value=ALL>全部</i-option> <i-option value=DONE>已完成</i-option> <i-option value=UNDONE>未完成</i-option> </i-select> </div> </div> </div> <div class=content> <div class=left-wrapper> <div class=rank1> <task :task-rank=1 :date-range=dateRange :task-type=taskType></task> </div> <div class=rank3> <task :task-rank=3 :date-range=dateRange :task-type=taskType></task> </div> </div> <div class=right-wrapper> <div class=rank2> <task :task-rank=2 :date-range=dateRange :task-type=taskType></task> </div> <div class=rank4> <task :task-rank=4 :date-range=dateRange :task-type=taskType></task> </div> </div> </div> </div> </div> '},function(t,e){t.exports=" <div class=task> <div class=task-add :class=classMap[taskRank]> <span class=task-description>{{textMap[taskRank]}}</span> <icon type=plus @click.stop=showInput></icon> </div> <div class=task-input v-show=addInputShow v-clickoutside=handleClose> <i-input icon=checkmark placeholder=输入任务描述,按回车键完成 v-on:on-enter=addTask v-on:on-click=addTask :value.sync=title></i-input> <date-picker type=daterange placeholder=选择日期 @click.stop :value.sync=taskDateRange></date-picker> </div> <div class=task-list> <i-table :columns=columns :data=taskList :height=height></i-table> </div> </div> "},function(t,e,a){var s,n,i={};a(8),s=a(4),n=a(11),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports.default);var o="function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports;n&&(o.template=n),o.computed||(o.computed={}),Object.keys(i).forEach(function(t){var e=i[t];o.computed[t]=function(){return e}})},function(t,e,a){var s,n,i={};a(9),s=a(5),n=a(12),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports.default);var o="function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports;n&&(o.template=n),o.computed||(o.computed={}),Object.keys(i).forEach(function(t){var e=i[t];o.computed[t]=function(){return e}})},,,function(t,e){}]);
//# sourceMappingURL=app.383f5418c9943cb6f3d3.js.map